<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for Registry/Registry.sol</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="../prettify.css" />
    <link rel="stylesheet" href="../base.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style type='text/css'>
        .coverage-summary .sorter {
            background-image: url(../sort-arrow-sprite.png);
        }
    </style>
</head>
<body>
<div class='wrapper'>
  <div class='pad1'>
    <h1>
      <a href="../index.html">all files</a> / <a href="index.html">Registry/</a> Registry.sol
    </h1>
    <div class='clearfix'>
      <div class='fl pad1y space-right2'>
        <span class="strong">0% </span>
        <span class="quiet">Statements</span>
        <span class='fraction'>0/21</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">0% </span>
        <span class="quiet">Branches</span>
        <span class='fraction'>0/4</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">0% </span>
        <span class="quiet">Functions</span>
        <span class='fraction'>0/8</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">0% </span>
        <span class="quiet">Lines</span>
        <span class='fraction'>0/20</span>
      </div>
    </div>
  </div>
  <div class='status-line low'></div>
<pre><table class="coverage">
<tr><td class="line-count quiet">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156</td><td class="line-coverage quiet"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">pragma solidity 0.6.2;
&nbsp;
/**
 * @title Registry
 * @dev Manages a Registry and it's entries.
*/
&nbsp;
import '../RegistryToken/RegistryToken.sol';
import '../Registry/Registry.sol';
import "../../node_modules/@openzeppelin/contracts-ethereum-package/contracts/math/SafeMath.sol";
&nbsp;
contract Registry is Initializable {
    using SafeMath for uint256;
&nbsp;
    string domain;
    string ref;
    string registryType;
    RegistryToken registryToken;
    address payable public registryTokenAddress;
&nbsp;
    struct RegistryEntry {
        string ref;
        bool isHuman;
    }
&nbsp;
    mapping(string =&gt; RegistryEntry) registryEntryMap;
    string[] registryEntries;
&nbsp;
    /// @notice Emitted when a new Registry is created.
    event RegistryEntryCreated(string subdomain, string ref);
&nbsp;
    /// @notice Emitted when the Registry ref is set.
    event RegistryRefSet(string ref);
&nbsp;
    /// @notice Emitted when the Registry entry ref is set.
    event RegistryEntryRefSet(string ref);
&nbsp;
    /**
     * @notice Initializes a new Registry after construction.
     * @param _domain The primary name used to represent the Registry. 
     * @param _ref The primary reference that a Registry links to. This can be any type of content and is typically used to reference an index or url.
     * @param _registryType The Registry's Type. Registry Types are defined globally at the Registrar and used to categorize Registries.
     * @param _registryToken The address of the Registry's Token. Registry Tokens are issued upon staking Infinity Token to transfer the ownership of a Registry Entry.
     */
&nbsp;
<span class="fstat-no" title="function not covered" >    function initialize(</span>
        string memory _domain,
        string memory _ref, 
        string memory _registryType, 
        RegistryToken _registryToken)
        public 
        initializer
    returns (string memory, string memory) 
    {
<span class="cstat-no" title="statement not covered" >        domain = _domain</span>;
<span class="cstat-no" title="statement not covered" >        ref = _ref</span>;
<span class="cstat-no" title="statement not covered" >        registryType = _registryType</span>;
<span class="cstat-no" title="statement not covered" >        registryToken = _registryToken</span>;
    }
&nbsp;
    // Add staking checks/logic here
&nbsp;
    /**
     * @notice Creates a new entry in the Registry.
     * @param _subdomain The subdomain to index the Registry.
     * @param _ref The reference the Registry entry will point to.
     */
&nbsp;
<span class="fstat-no" title="function not covered" >    function createRegistryEntry (</span>
        string memory _subdomain, 
        string memory _ref)
        public
    {
<span class="cstat-no" title="statement not covered" >        (bool _isRegistered, ) = isRegistered(_subdomain);</span>
<span class="cstat-no" title="statement not covered" >        if(!_isRegistered) {</span>
<span class="cstat-no" title="statement not covered" >            registryEntryMap[_subdomain].ref = _ref</span>;
<span class="cstat-no" title="statement not covered" >            registryEntryMap[_subdomain].isHuman = false</span>;
<span class="cstat-no" title="statement not covered" >            registryEntries.push(_subdomain)</span>;
&nbsp;
<span class="cstat-no" title="statement not covered" >            emit RegistryEntryCreated(_subdomain, _ref);</span>
        }
    }
&nbsp;
    /**
     * @notice Sets the reference for the Registry.
     * @param _newRef The new reference used for the Registry.
     */
&nbsp;
<span class="fstat-no" title="function not covered" >    function setRegistryRef (string memory _newRef) public {</span>
<span class="cstat-no" title="statement not covered" >        ref = _newRef</span>;
<span class="cstat-no" title="statement not covered" >        emit RegistryRefSet(ref);</span>
    }
&nbsp;
    /**
     * @notice Sets the subdomain for a Registry entry.
     * @param _subdomain The subdomain to index the Registry entry.
     */
&nbsp;
&nbsp;
<span class="fstat-no" title="function not covered" >    function setRegistryEntryRef (string memory _subdomain, string memory _newRef) public {</span>
<span class="cstat-no" title="statement not covered" >        registryEntryMap[_subdomain].ref = _newRef</span>;
<span class="cstat-no" title="statement not covered" >        emit RegistryEntryRefSet(registryEntryMap[_subdomain].ref);</span>
    }
&nbsp;
    /**
     * @notice Returns the domain, reference, type and RegistryToken address for a Registry. 
     */
&nbsp;
<span class="fstat-no" title="function not covered" >    function getRegistry() </span>
        public
        view
    returns(string memory, string memory, string memory, address)
    {
<span class="cstat-no" title="statement not covered" >        return(domain, ref, registryType, registryTokenAddress);</span>
    }
&nbsp;
    /**
     * @notice Returns the reference of a Registry.
     */
&nbsp;
<span class="fstat-no" title="function not covered" >    function getRef()</span>
        public
        view
    returns (string memory)
    {
<span class="cstat-no" title="statement not covered" >        return ref;</span>
    }
&nbsp;
    /**
     * @notice Returns the Reference for an entry in the Registry.
     * @param _subdomain The subdomain to index the Registry entry.
     */
&nbsp;
<span class="fstat-no" title="function not covered" >    function getRegistryEntryRef (string memory _subdomain) </span>
        public 
        view 
    returns (string memory) {
<span class="cstat-no" title="statement not covered" >        return registryEntryMap[_subdomain].ref;</span>
    }
&nbsp;
    /**s
     * @notice Returns a boolean representing whether a subdomain is registered within the Registry.
     * @param _subdomain The subdomain to index the Registry entry.
     */
&nbsp;
<span class="fstat-no" title="function not covered" >    function isRegistered(string memory _subdomain)</span>
       public
       view
    returns(bool, uint256)
    {
<span class="cstat-no" title="statement not covered" >        for (uint256 i = 0; i &lt; registryEntries.length; i += 1){</span>
<span class="cstat-no" title="statement not covered" >            if (keccak256(bytes(_subdomain)) == keccak256(bytes(registryEntries[i]))) <span class="cstat-no" title="statement not covered" >return (true, i);</span></span>
        }
<span class="cstat-no" title="statement not covered" >        return (false, 0);</span>
    }
}</pre></td></tr>
</table></pre>
<div class='push'></div><!-- for sticky footer -->
</div><!-- /wrapper -->
<div class='footer quiet pad2 space-top1 center small'>
  Code coverage
  generated by <a href="http://istanbul-js.org/" target="_blank">istanbul</a> at Mon Sep 14 2020 00:44:42 GMT-0700 (Pacific Daylight Time)
</div>
</div>
<script src="../prettify.js"></script>
<script>
window.onload = function () {
        if (typeof prettyPrint === 'function') {
            prettyPrint();
        }
};
</script>
<script src="../sorter.js"></script>
</body>
</html>
